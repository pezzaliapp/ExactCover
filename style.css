/* ======= TEMA & RESET ======= */
:root{
  color-scheme: dark;
  --header-h: 56px;     /* altezza appbar */
  --gap: 4px;           /* gap tra celle board */

  /* dimensioni palette compatte */
  --tile-w: 92px;       /* desktop/tablet */
  --tile-w-sm: 82px;    /* smartphone */
  --mini-sz: 14px;      /* cella mini anteprima desktop */
  --mini-sz-sm: 12px;   /* cella mini anteprima mobile */
}
*{ box-sizing: border-box; }
html{
  -webkit-text-size-adjust:100%;
  text-size-adjust:100%;
}
html, body{
  margin:0; background:#0b1220; color:#e7e7ef;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  min-height:100dvh; min-height:-webkit-fill-available;
  overflow-x:hidden;
}

/* ======= APPBAR & CONTROLLI ======= */
.appbar{
  position:sticky; top:0; z-index:30;
  background:#0b1220; border-bottom:1px solid #122142;
}
.appbar .brand{ padding:.75rem 1rem; }
.appbar h1{ margin:0; font-size:clamp(18px,2.2vw,28px); letter-spacing:.2px; }

.controls.panel{
  position:sticky; top:var(--header-h); z-index:25;
  background:#0b1220; padding:.7rem 1rem .55rem; border-bottom:1px solid #122142;
}
.controls{ display:flex; flex-wrap:wrap; gap:.55rem .6rem; align-items:center; }
.status{ margin:.4rem 1rem 0; opacity:.9; }

/* ======= LAYOUT GIOCO ======= */
.playfield{
  display:flex; flex-direction:column; gap:.75rem;
  padding:.75rem 1rem .6rem;
}

/* ======= BOARD ======= */
.board-wrap{ display:flex; justify-content:center; align-items:center; }
.board{
  /* Queste due variabili vengono aggiornate da script.js */
  --w: 10;  /* colonne */
  --h: 6;   /* righe */

  display:grid;
  grid-template-columns: repeat(var(--w), 1fr);
  grid-auto-rows: 1fr;                 /* celle sempre proporzionate in verticale */
  gap: var(--gap);

  /* proporzione fissa: celle quadrate nel contenitore */
  width:100%;
  max-width: 900px;                    /* aumenta/diminuisci per desktop */
  aspect-ratio: calc(var(--w) / var(--h));
  max-height: 60vh;                    /* lascia spazio alla palette su mobile */

  background:#0f1a33; padding:4px; border-radius:12px; border:1px solid #1a2a4d;
  user-select:none; -webkit-user-select:none; -webkit-touch-callout:none; touch-action:none;
}
.cell{ position:relative; background:#0e172b; border-radius:4px; }
.cell.dark{ background:#0c1425; }
.cell.hole{ background:#1b0f0f; }
.cell.piece{ outline:2px solid rgba(255,255,255,.22); border-radius:4px; filter:saturate(.95) brightness(1.02); }

/* Ghost / anteprima */
.cell.preview::after{
  content:""; position:absolute; inset:0; border-radius:3px;
  background:rgba(34,197,94,.30); outline:1px dashed rgba(34,197,94,.8);
}
.cell.preview.bad::after{
  background:rgba(239,68,68,.45); outline:1px dashed rgba(239,68,68,.9);
}

/* ======= PALETTE ======= */
.manual.panel2{ padding:0 1rem; border-top:1px solid #1a2a4d; background:#0b1220; }
.manual.panel2 h3{ margin:.35rem 0 .55rem; font-size:1rem; opacity:.95; }

.palette{
  display:flex; gap:.55rem;
  overflow-x:auto; overflow-y:hidden;
  padding:.35rem 0 calc(1rem + env(safe-area-inset-bottom));
  -webkit-overflow-scrolling:touch; scroll-snap-type:x proximity; touch-action:pan-x;
  overscroll-behavior-x:contain;
}
.palette::-webkit-scrollbar{ display:none; }
.palette > *{ scroll-snap-align:start; }

.tile{
  flex:0 0 var(--tile-w);
  background:#0f1a33; border:1px solid #1a2a4d; border-radius:12px;
  padding:10px; display:grid; gap:6px;
  user-select:none; -webkit-user-select:none; -webkit-touch-callout:none; touch-action:none;
}
.tile .mini{
  --sq:var(--mini-sz);
  display:grid; grid-template-columns:repeat(5,var(--sq)); grid-auto-rows:var(--sq);
  gap:3px; justify-content:center;
}
.tile .mini .cell{ width:var(--sq); height:var(--sq); background:#0e172b; border-radius:4px; }
.tile .mini .cell.on{ background:#1e90ff; }
.tile .label{ text-align:center; font-weight:700; opacity:.92; }

/* controlli “↻/⇋” interni alla tile (il tuo JS li crea) */
.tile .ctrls{ display:flex; gap:6px; justify-content:center; }
.tile .ctrls button{
  padding:6px 8px; border-radius:10px; background:#0b1326; border:1px solid #223055; color:#dbeafe;
  font-size:14px; line-height:1;
}

/* ======= UI: pulsanti e input (no zoom iOS) ======= */
button, .controls select, .controls input{ font-size:16px; line-height:1.15; }
button{ font-weight:700; letter-spacing:.2px; padding:10px 14px; border-radius:10px; }
button.ghost{ background:#ffffff; color:#0f172a; border:1px solid #3b82f6; }
button.ghost:hover{ background:#f1f5f9; border-color:#2563eb; }

/* ======= RESPONSIVE ======= */
@media (max-width: 768px){
  .tile{ flex:0 0 var(--tile-w-sm); padding:8px; }
  .tile .mini{ --sq:var(--mini-sz-sm); gap:2px; }
  .board{ max-width:100%; max-height:55vh; }
  .manual.panel2{
    position:sticky; bottom:0; z-index:20;
    padding:0 1rem calc(.8rem + env(safe-area-inset-bottom));
  }
}

@media (max-height: 520px) and (orientation: landscape){
  .controls.panel{ top:48px; padding:.55rem 1rem .45rem; }
  .board{ --gap:3px; max-height:60vh; }
  .manual.panel2{ position:static; padding:0 1rem .7rem; }
  .palette{ gap:.45rem; }
  .tile{ flex:0 0 76px; }
  .tile .mini{ --sq:11px; }
}

@media (min-width: 1100px){
  .tile{ flex:0 0 calc(var(--tile-w) + 6px); }
  .tile .mini{ --sq:16px; }
}
